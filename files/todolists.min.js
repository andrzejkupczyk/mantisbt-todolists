"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}(function(){window.ToDoList=new Vue({el:"#ToDoLists",props:["currentTasks","isReadonly","translations"],data:{newTask:{bug_id:0,description:"",descriptionHtml:""},tasks:[],lang:void 0},computed:{action:function action(){return this.$el.getElementsByTagName("FORM")[0].action},finishedTasks:function finishedTasks(){return this.tasks.filter(function(a){return a.finished})},counter:function counter(){var a=this.tasks.length-this.finishedTasks.length;return[a,this.tasks.length].join("/")}},methods:{insertTask:function insertTask(){var a=this;this.validateDescription(this.newTask.description)&&axios.post(this.action,{task:this.newTask}).then(function(b){var c;(c=a.tasks).push.apply(c,_toConsumableArray(b.data)),a.newTask.description=a.newTask.descriptionHtml=""})},updateTask:function updateTask(a){return axios.post(this.action,{task:a},{headers:{"x-http-method-override":"put"}})},deleteTask:function deleteTask(a){var b,c=this;(a.finished||confirm(null===(b=this.lang)||void 0===b?void 0:b.confirmDeletion))&&axios.post(this.action,{task:{id:a.id}},{headers:{"x-http-method-override":"delete"}}).then(function(){c.tasks.splice(c.tasks.indexOf(a),1)})},toggleFinished:function toggleFinished(a){a.finished=!!a.finished,this.updateTask(a).then(function(b){return a=Object.assign(a,b.data)},function(){return a.finished=!a.finished})},changeDescription:function changeDescription(a){var b,c=a.description,d=prompt(null===(b=this.lang)||void 0===b?void 0:b.enterNewDescription,a.description);this.validateDescription(d)&&d!==c&&(a.description=d,this.updateTask(a).then(function(b){return a.descriptionHtml=b.data.descriptionHtml},function(){return a.description=c}))},validateDescription:function validateDescription(a){return 0<(a?a.length:0)}},created:function created(){this.tasks=JSON.parse(null===this||void 0===this?void 0:this.currentTasks),this.lang=JSON.parse(null===this||void 0===this?void 0:this.translations)}})})();